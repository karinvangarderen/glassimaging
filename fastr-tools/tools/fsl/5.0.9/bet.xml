<tool id="Bet" name="Brain Extraction Tool from FSL" version="0.2">
  <authors>
    <author name="Marcel Zwiers" email="m.zwiers@donders.ru.nl" url="http://www.ru.nl/donders"/>
  </authors>
  <command version="5.0.9" url="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/BET">
    <authors>
      <author name="Mark Jenkinson"/>
      <author name="Steve Smith"/>
    </authors>
    <targets>
      <target os="linux"  arch="*" module="fsl/5.0.9" bin="bet">
	<paths>
          <path type="bin" value="/usr/local/fsl/bin/" />
          <path type="lib" value="/usr/local/fsl/lib/" />
        </paths>
	</target>
      <target os="darwin" arch="*" module="fsl/5.0.9" bin="bet"/>
    </targets>
    <description>
      BET (Brain Extraction Tool) deletes non-brain tissue from an image of the whole head. It can also estimate the inner and outer skull surfaces, and outer scalp surface, if you have good quality T1 and T2 input images.
    </description>
  </command>
  <interface>
    <inputs>
      <input id="image" name="Input image" datatype="NiftiImageFile"
             order="0" cardinality="1" required="True"/>
      <input id="fraction_threshold" name="Fractional intensity threshold" datatype="Float"
             prefix="-f" cardinality="1" required="False"/>
      <input id="fraction_gradient" name="Vertical gradient in fractional intensity threshold" datatype="Float" description="vertical gradient in fractional intensity threshold (-1->1); default=0; positive values give larger brain outline at bottom, smaller at top"
             prefix="-g" cardinality="1" required="False"/>
      <input id="head_radius" name="Head Radius (mm)" datatype="Float"
             prefix="-r" cardinality="1" required="False"/>
      <input id="center_of_gravity" name="Center of gravity coordinates (voxels)" datatype="Int" 
             prefix="-c" cardinality="3" required="False"/>
      <input id="apply_threshold" name="Apply thresholding to segmented brain image and mask" datatype="Boolean"
             prefix="-t" cardinality="1" required="False"/>
      <input id="robust_estimation" name="Robust brain centre estimation" datatype="Boolean"
             prefix="-R" cardinality="1" required="false"/>
      <input id="eye_cleanup" name="Eye and optic nerve cleanup" datatype="Boolean"
             prefix="-S" cardinality="1" required="false"/>
      <input id="bias_cleanup" name="Bias field and neck cleanup" datatype="Boolean"
             prefix="-B" cardinality="1" required="false"/>
      <input id="small_fov" name="Improve BET if FOV is very small in Z" datatype="Boolean"
             prefix="-Z" cardinality="1" required="false"/>
      <input id="apply_4D" name="apply to 4D FMRI data" datatype="Boolean"
             prefix="-F" cardinality="1" required="false"/>
      <input id="run_bet2_surf" name="Run bet2 and then betsurf" datatype="Boolean"
             prefix="-A" cardinality="1" required="false"/>
      <input id="T2_image" name="Non-brain-extracted T2 image" datatype="NiftiImageFile" description="as with -A, when also feeding in non-brain-extracted T2 (includes registrations)"
             prefix="-A2" cardinality="1" required="False"/>
    </inputs>
    <outputs>
      <output id="brain_image" name="Brain extracted output image" datatype="NiftiImageFileCompressed"
              order="1" cardinality="1" required="True"/>
      <output id="overlay_image" name="Brain surface outline overlaid onto original image" datatype="NiftiImageFileCompressed"
              prefix="-o" cardinality="1" required="False" automatic="True"
              location="{output_parts.brain_image[0].directory}/{output_parts.brain_image[0].basename}_overlay.{special.extension}"/>
      <output id="mask_image" name="Binary brain mask" datatype="NiftiImageFileCompressed"
              prefix="-m" cardinality="1" required="False" automatic="True"
              location="{output_parts.brain_image[0].directory}/{output_parts.brain_image[0].basename}_mask.{special.extension}"/>
      <output id="skull_image" name="Approximate skull image" datatype="NiftiImageFileCompressed"
              prefix="-s" cardinality="1" required="False" automatic="True"
              location="{output_parts.brain_image[0].directory}/{output_parts.brain_image[0].basename}_skull.{special.extension}"/>
      <!--output id="mesh_image" name="VTK mesh surface image" datatype="AnyFile"
              prefix="-e" cardinality="1" required="False" automatic="True"
              location="{output_parts.brain_image[0].directory}/{output_parts.brain_image[0].basename}_mesh.vtk"/-->
    </outputs>
  </interface>
  <cite>
    @Article {s.m.smith,
      author  = "Smith, S. M. ",
      title   = "Fast robust automated brain extraction",
      journal = "Human Brain Mapping",
      year    = "2002",
      volume  = "17",
      number  = "3",
      pages   = "143-155"
    }
    @Article {m.jenkinsonm.pechauds.smith2005,
      author  = "Jenkinson, M. and Pechaud, M. and Smith, S. ",
      title   = "BET2: MR-based estimation of brain, skull and scalp surfaces",
      journal = "Eleventh Annual Meeting of the Organization for Human Brain Mapping",
      year    = "2005"
    }
  </cite>
</tool>

<!--
Usage:    bet <input> <output> [options]

Main bet2 options:
  -o          generate brain surface outline overlaid onto original image
  -m          generate binary brain mask
  -s          generate approximate skull image
  -n          don't generate segmented brain image output
  -f <f>      fractional intensity threshold (0->1); default=0.5; smaller values give larger brain outline estimates
  -g <g>      vertical gradient in fractional intensity threshold (-1->1); default=0; positive values give larger brain outline at bottom, smaller at top
  -r <r>      head radius (mm not voxels); initial surface sphere is set to half of this
  -c <x y z>  centre-of-gravity (voxels not mm) of initial mesh surface.
  -t          apply thresholding to segmented brain image and mask
  -e          generates brain surface as mesh in .vtk format

Variations on default bet2 functionality (mutually exclusive options):
  (default)   just run bet2
  -R          robust brain centre estimation (iterates BET several times)
  -S          eye & optic nerve cleanup (can be useful in SIENA)
  -B          bias field & neck cleanup (can be useful in SIENA)
  -Z          improve BET if FOV is very small in Z (by temporarily padding end slices)
  -F          apply to 4D FMRI data (uses -f 0.3 and dilates brain mask slightly)
  -A          run bet2 and then betsurf to get additional skull and scalp surfaces (includes registrations)
  -A2 <T2>    as with -A, when also feeding in non-brain-extracted T2 (includes registrations)

Miscellaneous options:
  -v          verbose (switch on diagnostic messages)
  -h          display this help, then exits
  -d          debug (don't delete temporary intermediate images)
-->
